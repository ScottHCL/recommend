# 语义蒸馏

## 数据准备
使用llm大模型分别分析、理解用户行为
+ 输入：用户所有行为的物品描述，包括标题、简介、内容概述
+ 输出：<用户偏好原因，物品标签>二元组
## 小模型
**使用albert作为语义编码共享层，构建双塔小模型蒸馏大模型输出数据**
1. 用户向量：使用albert对用户物品标签进行编码，同时预测用户在类别、主题、内容、内容形式四个维度的偏好，每个维度为32维向量，拼接成128维向量作为用户总体偏好
2. 物品向量：使用albert对物品标题、简介、内容概述进行编码，同时预测物品在类别、主题、内容、内容形式四个维度的属性，每个维度为32维向量，拼接成128维向量作为物品总体向量
3. loss：
    + 蒸馏损失：
        + 物品标签蒸馏：使用物品向量与大模型输出物品标签的类别损失，使用sampled softmax loss
        + 用户偏好蒸馏：使用用户向量与大模型输出用户偏好标签的类别损失，使用sampled softmax loss
    + 匹配损失：
        + 物品向量：使用物品向量与用户向量的cosine相似度作为损失函数，使用sampled softmax loss

## 效果评估

### 模型评估
1. 物品标签准确率：使用小模型预测物品标签与大模型输出物品标签的准确率
2. 用户偏好准确率：使用小模型预测用户偏好标签与大模型输出用户偏好标签的准确率
3. 匹配召回率：用户实际消费的物品的标签中，小模型召回的物品实际包含消费标签的比例
### 实验评估
1. 行为稀疏内容分发效率：点击率、播放率
2. 行为稀疏内容曝光量