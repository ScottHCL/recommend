# 意图生成



## 模型微调

### 意图生成微调
#### 数据准备
1. 输入：用户所有行为的物品描述，包括标题、简介、内容概述
2. 输出：综合用户全局行为，生成用户在类别、主题、内容、内容形式四个维度的偏好意图
#### qwen意图生成微调
1. 知识注入
    + 物品信息注入：输入物品标题、简介、内容概述，输出物品在类别、主题、内容、内容形式四个维度的属性
    + 用户行为注入：输入用户所有行为的物品描述，输出用户下一个物品标题
    + 全局意图注入：输入用户所有行为的物品描述，综合用户全局行为，生成用户在类别、主题、内容、内容形式四个维度的偏好意图
2. 微调方法：lora低秩微调

#### 在线服务
1. 模型部署：使用torchserve部署qwen意图生成模型
2. 批量推理：对仅半年低频用户，使用批量推理方式，预计算用户在四个维度的偏好意图，写入缓存
3. 增量更新：未命中缓存用户，使用在线推理方式，更新用户在四个维度的偏好意图，写入缓存，第二刷时展示结果
#### 微调遇到问题
1. 输入长度限制
2. 灾难性遗忘
3. 在线部署

### 具体内容生成微调

#### 数据准备
1. 聚类：使用qwen大模型对所用物品文本编码，得到语义向量。再基于语义向量进行聚类，将物品分为多个类别id
2. 替换：将用户所有物品序列替换为物品类别id序列

#### 具体内容生成微调
1. prompt知识注入
    + 1. 物品属性知识注入：输入物品文本描述，输出物品类别id
    + 2. 用户行为知识注入：
        + 输入：用户所有行为的物品类别id序列
        + 输出：预测用户下一个物品类别id
2. 微调方法：lora低秩微调